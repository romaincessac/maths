\ProvidesPackage{liseret}[2010/08/06 version 1]

\RequirePackage{xkeyval}
\RequirePackage{eso-pic}
\RequirePackage{graphicx}
\RequirePackage{eso-pic}
\RequirePackage{xcolor}
\RequirePackage{ifthen}
\RequirePackage{calc}

\newcommand\liseret@At@Page@Upper@Right[1]{%
  \put(\LenToUnit{\paperwidth},\LenToUnit{\paperheight}){#1}%
}
\newcommand\liseret@AtPageLowerRight[1]{\liseret@At@Page@Upper@Right{%
  \put(0,\LenToUnit{-\paperheight}){\llap{#1}}}}

\AddToShipoutPicture{%
  \ifthenelse{\isodd{\value{page}}}{%
    \AtPageLowerLeft{%
       \liseret@odd@left
    }%
    \liseret@AtPageLowerRight{%
       \liseret@odd@right
    }%
  }%
  {%
    \AtPageLowerLeft{%
       \liseret@even@left
    }%
    \liseret@AtPageLowerRight{%
       \liseret@even@right
    }%
  }%
}

\newif\ifliseret@left@
\newif\ifliseret@right@
\newif\ifliseret@external@
\newif\ifliseret@internal@
\liseret@left@false
\liseret@right@false
\liseret@external@false
\liseret@internal@false

\define@choicekey*{liseret}{position}[\val\liseret@position@nr]{left,right,external,internal}{%
  \ifcase\liseret@position@nr\relax
    \liseret@left@true\liseret@right@false
    \liseret@external@false\liseret@internal@false
  \or
    \liseret@left@false\liseret@right@true
    \liseret@external@false\liseret@internal@false
  \or
    \liseret@left@false\liseret@right@false
    \liseret@external@true\liseret@internal@false
  \or
    \liseret@left@false\liseret@right@false
    \liseret@external@false\liseret@internal@true
  \fi
}

\define@choicekey*{liseret}{align}[\val\liseret@align@nr]{bottom,top,center}{%
  \ifcase\liseret@align@nr\relax
    \def\liseret@align{\raggedright}
  \or
    \def\liseret@align{\raggedleft}
  \or
    \def\liseret@align{\centering}
  \fi
}

\define@key{liseret}{color}{\def\liseret@color{#1}}
\define@key{liseret}{textcolor}{\def\liseret@textcolor{#1}}
\define@key{liseret}{font}{\def\liseret@font{#1}}
\define@key{liseret}{sep}{\def\liseret@sep{#1}}

\newcommand{\liseret}[2][]{%
  \setkeys{liseret}{position=external,
                    align=center,
                    color=orange,
                    textcolor=white,
                    font=\sffamily,
                    sep=0pt
                   }%
  \setkeys{liseret}{#1}%
  \ifliseret@left@
    \def\liseret@odd@left{\make@liseret{#2}}
    \def\liseret@even@left{\make@liseret{#2}}
    \def\liseret@odd@right{}
    \def\liseret@even@right{}
  \fi
  \ifliseret@right@
    \def\liseret@odd@left{}
    \def\liseret@even@left{}
    \def\liseret@odd@right{\make@liseret{#2}}
    \def\liseret@even@right{\make@liseret{#2}}
  \fi
  \ifliseret@external@
    \def\liseret@odd@left{}
    \def\liseret@even@left{\make@liseret{#2}}
    \def\liseret@odd@right{\make@liseret{#2}}
    \def\liseret@even@right{}
  \fi
  \ifliseret@internal@
    \def\liseret@odd@left{\make@liseret{#2}}
    \def\liseret@even@left{}
    \def\liseret@odd@right{}
    \def\liseret@even@right{\make@liseret{#2}}
  \fi
}

\newcommand{\make@liseret}[1]{%
  \rotatebox{90}{\colorbox{\liseret@color}{%
    \begin{minipage}{\paperheight-2\fboxsep}%
    \liseret@align\liseret@font
    \vspace{\liseret@sep}%
      \textcolor{\liseret@textcolor}{#1}%
    \vspace{\liseret@sep}%
    \end{minipage}%
  }}%
}

\endinput
